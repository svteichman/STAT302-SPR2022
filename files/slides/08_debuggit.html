<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>STAT 302, Lecture Slides 8</title>
    <meta charset="utf-8" />
    <meta name="author" content="Sarah Teichman (adapted from slides by Bryan Martin and Peter Gao)" />
    <link href="08_debuggit_files/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="gao-theme.css" type="text/css" />
    <link rel="stylesheet" href="gao-theme-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, title-slide

# STAT 302, Lecture Slides 8
## Debugging and Version Control
### Sarah Teichman (adapted from slides by Bryan Martin and Peter Gao)

---




# Today's pet picture 


&lt;img src="../../files/images/pets/pig_nutmeg.jpg" width="700px" style="display: block; margin: auto;" /&gt;

---

# Outline

1. Debugging
2. Version Control

.middler[**Goal:** Learn how to understand and fix R errors independently and get started with git!]

---

class: inverse

.sectionhead[Part 1. Debugging]

---

# Acknowledgement

This section heavily borrows from materials by Hadley Wickham, Jennifer Bryan, and Jim Hester.

* [Hadley Wickham's Advanced R - Debugging](https://adv-r.hadley.nz/debugging.html)
* [Jennifer Bryan and Jim Hester's What they Forgot to Teach You About R - Debugging R Code](https://rstats.wtf/debugging-r-code.html)

Our [cheatsheet](https://github.com/ajmcoqui/debuggingRStudio/blob/b70a3575a3ff5e7867b05fb5e84568abba426c4b/RStudio_Debugging_Cheatsheet.pdf) comes from Amanda Gadrow.

---

# Step 1: Google!

Seriously. Always. When you see an error code you don't understand, Google it!

Not only that, Google the **exact text** of your error message (except for any references to filepaths, etc.).
R has millions of users and an incredibly active online community. If you encounter any error message, chances are someone has had to debug that exact error in the past.

---

# Step 1: Google!


```r
nums &lt;- c(1, 2, 3, 4, "5")
nums[1] + 1
```

```
## Error in nums[1] + 1: non-numeric argument to binary operator
```

---

# Step 1: Google!


```r
df &lt;- readr::read_csv("data.csv")
```

```
## Error: 'data.csv' does not exist in current working directory ('/Users/sarahteichman/Documents/UW/302/STAT302-SPR2022/files/slides').
```

---

# Step 2: Reset!

You will be amazed at how many issues will be solved by closing and re-opening R. This will be especially true when we get into package building. 

Sometimes, things get weird with your workspace, and you just need to start with a clean slate. It can be frustrating, because you don't know what was causing the issue, but also a relief, because it will be fixed!

Resetting will:

* Clear your workspace (better than `rm(list = ls()`!)
* Reset your options to their defaults (an easy one to miss!)
* Clear your search path (the order R looks for things)

---

# Step 3: Repeat!

When you encounter a bug, try to repeat it! Likely, it came about for a reason. 

When you do repeat it, you should repeat it with a minimal working example. This means you should remove as much code and simplify as much data as possible.

* Small and simple inputs
* No extraneous packages
* No unnecessary function calls

Example: did your function break with a large data matrix of real-world data stored within a package? How about if you just use a `\(3 \times 3\)` matrix of `\(1\)`'s? 

---

# Step 3: Repeat!




```r
data(mtcars)
my_lm(hp ~ mpg, data = mtcars)
```

```
## Error in se_mat[i, i]: subscript out of bounds
```

---

# Step 3: Repeat!


```r
my_df &lt;- data.frame(y = 1:3,
                    x = 2:4)
my_df
```

```
##   y x
## 1 1 2
## 2 2 3
## 3 3 4
```

```r
my_lm(y ~ x, my_df)
```

```
## Error in se_mat[i, i]: subscript out of bounds
```

---

# Step 3: Repeat!


```r
sum &lt;- function(vec) {
  curr &lt;- 0 
  for (i in 1:length(vec)) {
    curr &lt;- curr + vec[i]
  }
  return(curr + 1)
}
```


```r
sum(seq(from = 5, to = 500, by = 5))
```

```
## [1] 25251
```

---

# Step 3: Repeat!


```r
sum(c(1, 2, 3))
```

```
## [1] 7
```

---

# Step 4: Locate!

If you weren't able to fix a bug the "easy" way (found the solution on Google or just needed a reset), and you have a minimal working example demonstrating your bug, then you are ready for the really hard part: 
finding the bug.

Often (not always), once you find a bug, it is rather easy to fix.

---
layout: true
# &lt;TT&gt;traceback()&lt;/TT&gt;: call stack

---

Sometimes functions(in functions(in functions(in functions(...)))) can get complicated...


```r
f &lt;- function(a) g(a)
g &lt;- function(b) h(b)
h &lt;- function(c) i(c)
i &lt;- function(d) {
  if (!is.numeric(d)) {
    stop("`d` must be numeric", call. = FALSE)
  }
  d + 10
}
f(5)
```

```
## [1] 15
```

```r
f(1:3)
```

```
## [1] 11 12 13
```

---

.center[&lt;img src="images/traceback.png" alt="" height="50"/&gt;]




```r
f("a")
```


```r
traceback() # Or, just click traceback within RStudio
```


```
## Error: `d` must be numeric
```

```
## 5: stop("`d` must be numeric", call. = FALSE)
## 4: i(c)
## 3: h(b)
## 2: g(a)
## 1: f("a")
```

This is called a **call stack**.

---


```
## Error: `d` must be numeric
```

```
## 5: stop("`d` must be numeric", call. = FALSE)
## 4: i(c)
## 3: h(b)
## 2: g(a)
## 1: f("a")
```

Read from bottom to top:
1. First call was to `f("a")`
2. Second call was `g(a)`
3. Third call was `h(b)`
4. Fourth call was `i(c)`
5. Fifth and last call was our error message, so we know `i(c)` triggered our error!

But we're not done yet...

We now know that our error occurred within `i(c)`, but we don't know *where* within `i(c)` our error occurred.

---

Note this is done in your **Console**, not your **Editor** pane! This is typically not a part of your reproducible workflow, this is you figuring out your own problems until you fix what actually belongs in your workflow.

Once you have the bug fixed, *then* put the debugged code in your Editor pane. 
In general, most debugging will be done through the **Console**!

---
layout: false
layout: true
# &lt;TT&gt;print(), cat(), str()&lt;/TT&gt;: messages
---

Take your function, throw in a `print()` statement to see what the function is seeing.




```r
i &lt;- function(d) {
  print(d)
  if (!is.numeric(d)) {
    stop("`d` must be numeric", call. = FALSE)
  }
  d + 10
}
f("a")
```

```
## [1] "a"
```

```
## Error: `d` must be numeric
```

This is a quick and easy way to find bugs quickly. Probably the most common first step when manually debugging!
---

Take your function, throw in a `cat()` statement to see what the function is seeing. 



```r
i &lt;- function(d) {
  cat("The value of input parameter d is:", d, "\n")
  cat("The class of input parameter d is:", class(d), "\n")
  if (!is.numeric(d)) {
    stop("`d` must be numeric", call. = FALSE)
  }
  d + 10
}
f("a")
```

```
## The value of input parameter d is: a 
## The class of input parameter d is: character
```

```
## Error: `d` must be numeric
```

I like to use `cat()` when I want to print myself more informative error messages, or when I want to print out multiple messages so that I can tell them apart.
---

Take your function, throw in a `str()` statement to see what the function is seeing.


```r
i &lt;- function(d) {
  str(d)
  if (!is.numeric(d)) {
    stop("`d` must be numeric", call. = FALSE)
  }
  d + 10
}
f("a")
```

```
##  chr "a"
```

```
## Error: `d` must be numeric
```

More specifically, `str()` can be used to see *the structure of* what the function is seeing. 
This can often be more informative if the structure is not what you expect (a common source of bugs!).

---

The main downside to these approaches is that it can get messy quickly if you use multiple print statements, and you cannot further investigate the object. 
However, many bugs come down to typos or other trivial errors, and print statements are often all you need!

---


```r
sum_matrix &lt;- function(mat) {
  curr_sum &lt;- 0
  for (i in 1:(nrow(mat) + 1)) {
    for (j in 1:ncol(mat)) {
      curr_sum &lt;- curr_sum + mat[i, j]
      cat("i is ", i, "\n")
      cat("j is ", j, "\n")
      cat("sum is ", curr_sum, "\n")
    }
  }
}
```

---


```r
sum_matrix(matrix(rnorm(6), nrow = 3))
```

```
## i is  1 
## j is  1 
## sum is  -0.525414 
## i is  1 
## j is  2 
## sum is  1.488625 
## i is  2 
## j is  1 
## sum is  2.198257 
## i is  2 
## j is  2 
## sum is  1.498659 
## i is  3 
## j is  1 
## sum is  -0.008524981 
## i is  3 
## j is  2 
## sum is  -0.3442097
```

```
## Error in mat[i, j]: subscript out of bounds
```

---


```r
sum_matrix(matrix(rnorm(500), nrow = 100))
```

```
## i is  1 
## j is  1 
## sum is  -0.3848421 
## i is  1 
## j is  2 
## sum is  -1.362627 
## i is  1 
## j is  3 
## sum is  -1.013921 
## i is  1 
## j is  4 
## sum is  -2.165218 
## i is  1 
## j is  5 
## sum is  -1.658525 
## i is  2 
## j is  1 
## sum is  -2.335486 
## i is  2 
## j is  2 
## sum is  -2.739613 
## i is  2 
## j is  3 
## sum is  -2.002694 
## i is  2 
## j is  4 
## sum is  -1.02304 
## i is  2 
## j is  5 
## sum is  -0.01850162 
## i is  3 
## j is  1 
## sum is  -0.7391867 
## i is  3 
## j is  2 
## sum is  -0.4980746 
## i is  3 
## j is  3 
## sum is  -0.637796 
## i is  3 
## j is  4 
## sum is  -0.8156758 
## i is  3 
## j is  5 
## sum is  -0.5996236 
## i is  4 
## j is  1 
## sum is  -1.671315 
## i is  4 
## j is  2 
## sum is  -2.402568 
## i is  4 
## j is  3 
## sum is  -2.038901 
## i is  4 
## j is  4 
## sum is  -1.3634 
## i is  4 
## j is  5 
## sum is  -2.191899 
## i is  5 
## j is  1 
## sum is  -0.5214038 
## i is  5 
## j is  2 
## sum is  -1.023722 
## i is  5 
## j is  3 
## sum is  0.184767 
## i is  5 
## j is  4 
## sum is  0.9403985 
## i is  5 
## j is  5 
## sum is  1.675558 
## i is  6 
## j is  1 
## sum is  0.491811 
## i is  6 
## j is  2 
## sum is  0.1684534 
## i is  6 
## j is  3 
## sum is  0.3408869 
## i is  6 
## j is  4 
## sum is  -1.159021 
## i is  6 
## j is  5 
## sum is  0.5017497 
## i is  7 
## j is  1 
## sum is  0.1802392 
## i is  7 
## j is  2 
## sum is  0.06061116 
## i is  7 
## j is  3 
## sum is  -0.2144428 
## i is  7 
## j is  4 
## sum is  -0.6871291 
## i is  7 
## j is  5 
## sum is  -0.6058807 
## i is  8 
## j is  1 
## sum is  -0.015798 
## i is  8 
## j is  2 
## sum is  0.2190691 
## i is  8 
## j is  3 
## sum is  2.288748 
## i is  8 
## j is  4 
## sum is  1.33158 
## i is  8 
## j is  5 
## sum is  2.747866 
## i is  9 
## j is  1 
## sum is  2.167675 
## i is  9 
## j is  2 
## sum is  2.552833 
## i is  9 
## j is  3 
## sum is  2.946676 
## i is  9 
## j is  4 
## sum is  2.180861 
## i is  9 
## j is  5 
## sum is  0.8735899 
## i is  10 
## j is  1 
## sum is  1.624249 
## i is  10 
## j is  2 
## sum is  2.463084 
## i is  10 
## j is  3 
## sum is  3.43817 
## i is  10 
## j is  4 
## sum is  4.038499 
## i is  10 
## j is  5 
## sum is  3.159081 
## i is  11 
## j is  1 
## sum is  4.181084 
## i is  11 
## j is  2 
## sum is  5.040303 
## i is  11 
## j is  3 
## sum is  4.041305 
## i is  11 
## j is  4 
## sum is  2.866512 
## i is  11 
## j is  5 
## sum is  2.989134 
## i is  12 
## j is  1 
## sum is  3.038568 
## i is  12 
## j is  2 
## sum is  5.121227 
## i is  12 
## j is  3 
## sum is  4.500361 
## i is  12 
## j is  4 
## sum is  3.835593 
## i is  12 
## j is  5 
## sum is  3.281009 
## i is  13 
## j is  1 
## sum is  4.777404 
## i is  13 
## j is  2 
## sum is  4.098155 
## i is  13 
## j is  3 
## sum is  3.774436 
## i is  13 
## j is  4 
## sum is  4.378445 
## i is  13 
## j is  5 
## sum is  5.830014 
## i is  14 
## j is  1 
## sum is  5.166102 
## i is  14 
## j is  2 
## sum is  4.547378 
## i is  14 
## j is  3 
## sum is  3.694241 
## i is  14 
## j is  4 
## sum is  3.776184 
## i is  14 
## j is  5 
## sum is  1.672002 
## i is  15 
## j is  1 
## sum is  1.73528 
## i is  15 
## j is  2 
## sum is  1.796657 
## i is  15 
## j is  3 
## sum is  0.9844289 
## i is  15 
## j is  4 
## sum is  0.01147393 
## i is  15 
## j is  5 
## sum is  0.3496017 
## i is  16 
## j is  1 
## sum is  -0.8095987 
## i is  16 
## j is  2 
## sum is  0.2482675 
## i is  16 
## j is  3 
## sum is  -0.9924905 
## i is  16 
## j is  4 
## sum is  -1.735668 
## i is  16 
## j is  5 
## sum is  -2.489759 
## i is  17 
## j is  1 
## sum is  -3.83051 
## i is  17 
## j is  2 
## sum is  -4.946888 
## i is  17 
## j is  3 
## sum is  -4.49013 
## i is  17 
## j is  4 
## sum is  -5.360349 
## i is  17 
## j is  5 
## sum is  -5.319286 
## i is  18 
## j is  1 
## sum is  -6.349673 
## i is  18 
## j is  2 
## sum is  -6.092634 
## i is  18 
## j is  3 
## sum is  -6.829986 
## i is  18 
## j is  4 
## sum is  -6.719998 
## i is  18 
## j is  5 
## sum is  -8.393981 
## i is  19 
## j is  1 
## sum is  -6.817708 
## i is  19 
## j is  2 
## sum is  -7.775487 
## i is  19 
## j is  3 
## sum is  -8.384238 
## i is  19 
## j is  4 
## sum is  -9.276189 
## i is  19 
## j is  5 
## sum is  -7.911281 
## i is  20 
## j is  1 
## sum is  -9.008479 
## i is  20 
## j is  2 
## sum is  -9.949895 
## i is  20 
## j is  3 
## sum is  -11.70468 
## i is  20 
## j is  4 
## sum is  -11.6004 
## i is  20 
## j is  5 
## sum is  -13.04954 
## i is  21 
## j is  1 
## sum is  -15.27329 
## i is  21 
## j is  2 
## sum is  -16.31964 
## i is  21 
## j is  3 
## sum is  -15.65269 
## i is  21 
## j is  4 
## sum is  -16.5706 
## i is  21 
## j is  5 
## sum is  -16.81527 
## i is  22 
## j is  1 
## sum is  -16.46188 
## i is  22 
## j is  2 
## sum is  -17.08785 
## i is  22 
## j is  3 
## sum is  -17.73987 
## i is  22 
## j is  4 
## sum is  -17.62767 
## i is  22 
## j is  5 
## sum is  -16.49927 
## i is  23 
## j is  1 
## sum is  -16.96161 
## i is  23 
## j is  2 
## sum is  -16.84293 
## i is  23 
## j is  3 
## sum is  -16.66055 
## i is  23 
## j is  4 
## sum is  -15.82018 
## i is  23 
## j is  5 
## sum is  -15.8444 
## i is  24 
## j is  1 
## sum is  -16.98045 
## i is  24 
## j is  2 
## sum is  -17.69553 
## i is  24 
## j is  3 
## sum is  -17.51958 
## i is  24 
## j is  4 
## sum is  -17.18457 
## i is  24 
## j is  5 
## sum is  -14.91361 
## i is  25 
## j is  1 
## sum is  -15.32576 
## i is  25 
## j is  2 
## sum is  -14.3349 
## i is  25 
## j is  3 
## sum is  -13.76958 
## i is  25 
## j is  4 
## sum is  -12.52717 
## i is  25 
## j is  5 
## sum is  -11.48586 
## i is  26 
## j is  1 
## sum is  -11.26481 
## i is  26 
## j is  2 
## sum is  -10.81358 
## i is  26 
## j is  3 
## sum is  -12.01013 
## i is  26 
## j is  4 
## sum is  -12.18034 
## i is  26 
## j is  5 
## sum is  -12.18548 
## i is  27 
## j is  1 
## sum is  -12.93099 
## i is  27 
## j is  2 
## sum is  -12.2764 
## i is  27 
## j is  3 
## sum is  -11.04666 
## i is  27 
## j is  4 
## sum is  -12.28495 
## i is  27 
## j is  5 
## sum is  -11.78645 
## i is  28 
## j is  1 
## sum is  -13.17381 
## i is  28 
## j is  2 
## sum is  -11.2942 
## i is  28 
## j is  3 
## sum is  -12.17943 
## i is  28 
## j is  4 
## sum is  -12.56592 
## i is  28 
## j is  5 
## sum is  -12.02056 
## i is  29 
## j is  1 
## sum is  -11.0604 
## i is  29 
## j is  2 
## sum is  -11.18431 
## i is  29 
## j is  3 
## sum is  -13.22295 
## i is  29 
## j is  4 
## sum is  -13.87789 
## i is  29 
## j is  5 
## sum is  -13.71652 
## i is  30 
## j is  1 
## sum is  -12.603 
## i is  30 
## j is  2 
## sum is  -11.69173 
## i is  30 
## j is  3 
## sum is  -13.27543 
## i is  30 
## j is  4 
## sum is  -13.11214 
## i is  30 
## j is  5 
## sum is  -11.59159 
## i is  31 
## j is  1 
## sum is  -11.10162 
## i is  31 
## j is  2 
## sum is  -10.86009 
## i is  31 
## j is  3 
## sum is  -10.56462 
## i is  31 
## j is  4 
## sum is  -9.537921 
## i is  31 
## j is  5 
## sum is  -9.344185 
## i is  32 
## j is  1 
## sum is  -8.924197 
## i is  32 
## j is  2 
## sum is  -8.298761 
## i is  32 
## j is  3 
## sum is  -10.28171 
## i is  32 
## j is  4 
## sum is  -9.588245 
## i is  32 
## j is  5 
## sum is  -8.913767 
## i is  33 
## j is  1 
## sum is  -9.665884 
## i is  33 
## j is  2 
## sum is  -10.3413 
## i is  33 
## j is  3 
## sum is  -9.47933 
## i is  33 
## j is  4 
## sum is  -7.786361 
## i is  33 
## j is  5 
## sum is  -7.619748 
## i is  34 
## j is  1 
## sum is  -7.425245 
## i is  34 
## j is  2 
## sum is  -7.155406 
## i is  34 
## j is  3 
## sum is  -7.292311 
## i is  34 
## j is  4 
## sum is  -8.015665 
## i is  34 
## j is  5 
## sum is  -8.802018 
## i is  35 
## j is  1 
## sum is  -8.924007 
## i is  35 
## j is  2 
## sum is  -9.98825 
## i is  35 
## j is  3 
## sum is  -10.06324 
## i is  35 
## j is  4 
## sum is  -11.13194 
## i is  35 
## j is  5 
## sum is  -9.559339 
## i is  36 
## j is  1 
## sum is  -8.576788 
## i is  36 
## j is  2 
## sum is  -8.845893 
## i is  36 
## j is  3 
## sum is  -9.513639 
## i is  36 
## j is  4 
## sum is  -10.7934 
## i is  36 
## j is  5 
## sum is  -13.2929 
## i is  37 
## j is  1 
## sum is  -14.094 
## i is  37 
## j is  2 
## sum is  -15.34902 
## i is  37 
## j is  3 
## sum is  -15.18755 
## i is  37 
## j is  4 
## sum is  -15.68691 
## i is  37 
## j is  5 
## sum is  -16.3395 
## i is  38 
## j is  1 
## sum is  -17.01778 
## i is  38 
## j is  2 
## sum is  -17.29322 
## i is  38 
## j is  3 
## sum is  -15.84603 
## i is  38 
## j is  4 
## sum is  -16.40153 
## i is  38 
## j is  5 
## sum is  -16.03652 
## i is  39 
## j is  1 
## sum is  -16.74834 
## i is  39 
## j is  2 
## sum is  -15.51359 
## i is  39 
## j is  3 
## sum is  -15.67928 
## i is  39 
## j is  4 
## sum is  -15.84002 
## i is  39 
## j is  5 
## sum is  -14.89247 
## i is  40 
## j is  1 
## sum is  -15.7001 
## i is  40 
## j is  2 
## sum is  -13.95094 
## i is  40 
## j is  3 
## sum is  -13.88428 
## i is  40 
## j is  4 
## sum is  -14.17471 
## i is  40 
## j is  5 
## sum is  -15.6574 
## i is  41 
## j is  1 
## sum is  -14.51066 
## i is  41 
## j is  2 
## sum is  -15.38531 
## i is  41 
## j is  3 
## sum is  -15.75743 
## i is  41 
## j is  4 
## sum is  -17.39286 
## i is  41 
## j is  5 
## sum is  -16.22828 
## i is  42 
## j is  1 
## sum is  -15.03357 
## i is  42 
## j is  2 
## sum is  -14.50019 
## i is  42 
## j is  3 
## sum is  -15.98258 
## i is  42 
## j is  4 
## sum is  -15.14709 
## i is  42 
## j is  5 
## sum is  -15.5922 
## i is  43 
## j is  1 
## sum is  -17.55825 
## i is  43 
## j is  2 
## sum is  -18.80094 
## i is  43 
## j is  3 
## sum is  -19.14009 
## i is  43 
## j is  4 
## sum is  -20.1857 
## i is  43 
## j is  5 
## sum is  -21.80031 
## i is  44 
## j is  1 
## sum is  -21.88315 
## i is  44 
## j is  2 
## sum is  -22.11845 
## i is  44 
## j is  3 
## sum is  -23.05097 
## i is  44 
## j is  4 
## sum is  -22.64797 
## i is  44 
## j is  5 
## sum is  -23.43493 
## i is  45 
## j is  1 
## sum is  -24.67675 
## i is  45 
## j is  2 
## sum is  -24.49661 
## i is  45 
## j is  3 
## sum is  -25.75712 
## i is  45 
## j is  4 
## sum is  -24.82793 
## i is  45 
## j is  5 
## sum is  -24.97151 
## i is  46 
## j is  1 
## sum is  -25.11661 
## i is  46 
## j is  2 
## sum is  -26.06073 
## i is  46 
## j is  3 
## sum is  -26.14947 
## i is  46 
## j is  4 
## sum is  -26.68237 
## i is  46 
## j is  5 
## sum is  -27.83991 
## i is  47 
## j is  1 
## sum is  -26.67148 
## i is  47 
## j is  2 
## sum is  -26.05468 
## i is  47 
## j is  3 
## sum is  -26.73516 
## i is  47 
## j is  4 
## sum is  -25.90046 
## i is  47 
## j is  5 
## sum is  -27.33967 
## i is  48 
## j is  1 
## sum is  -27.02536 
## i is  48 
## j is  2 
## sum is  -28.30359 
## i is  48 
## j is  3 
## sum is  -25.83973 
## i is  48 
## j is  4 
## sum is  -25.3203 
## i is  48 
## j is  5 
## sum is  -25.06568 
## i is  49 
## j is  1 
## sum is  -25.7889 
## i is  49 
## j is  2 
## sum is  -23.67387 
## i is  49 
## j is  3 
## sum is  -24.1234 
## i is  49 
## j is  4 
## sum is  -22.30606 
## i is  49 
## j is  5 
## sum is  -24.93399 
## i is  50 
## j is  1 
## sum is  -25.53541 
## i is  50 
## j is  2 
## sum is  -24.17937 
## i is  50 
## j is  3 
## sum is  -24.16809 
## i is  50 
## j is  4 
## sum is  -24.56516 
## i is  50 
## j is  5 
## sum is  -22.55243 
## i is  51 
## j is  1 
## sum is  -22.43062 
## i is  51 
## j is  2 
## sum is  -22.46227 
## i is  51 
## j is  3 
## sum is  -23.43667 
## i is  51 
## j is  4 
## sum is  -22.48451 
## i is  51 
## j is  5 
## sum is  -22.69898 
## i is  52 
## j is  1 
## sum is  -21.17274 
## i is  52 
## j is  2 
## sum is  -19.97547 
## i is  52 
## j is  3 
## sum is  -19.26908 
## i is  52 
## j is  4 
## sum is  -18.06387 
## i is  52 
## j is  5 
## sum is  -17.58801 
## i is  53 
## j is  1 
## sum is  -17.30312 
## i is  53 
## j is  2 
## sum is  -18.41321 
## i is  53 
## j is  3 
## sum is  -18.78513 
## i is  53 
## j is  4 
## sum is  -18.41343 
## i is  53 
## j is  5 
## sum is  -19.372 
## i is  54 
## j is  1 
## sum is  -20.71162 
## i is  54 
## j is  2 
## sum is  -21.06476 
## i is  54 
## j is  3 
## sum is  -20.91844 
## i is  54 
## j is  4 
## sum is  -20.38993 
## i is  54 
## j is  5 
## sum is  -21.05583 
## i is  55 
## j is  1 
## sum is  -19.62448 
## i is  55 
## j is  2 
## sum is  -21.01186 
## i is  55 
## j is  3 
## sum is  -21.11851 
## i is  55 
## j is  4 
## sum is  -22.38111 
## i is  55 
## j is  5 
## sum is  -22.73197 
## i is  56 
## j is  1 
## sum is  -23.10024 
## i is  56 
## j is  2 
## sum is  -22.03114 
## i is  56 
## j is  3 
## sum is  -22.44685 
## i is  56 
## j is  4 
## sum is  -21.06245 
## i is  56 
## j is  5 
## sum is  -20.55286 
## i is  57 
## j is  1 
## sum is  -19.55134 
## i is  57 
## j is  2 
## sum is  -18.65546 
## i is  57 
## j is  3 
## sum is  -17.03353 
## i is  57 
## j is  4 
## sum is  -17.00099 
## i is  57 
## j is  5 
## sum is  -15.02452 
## i is  58 
## j is  1 
## sum is  -15.37767 
## i is  58 
## j is  2 
## sum is  -14.69015 
## i is  58 
## j is  3 
## sum is  -15.91043 
## i is  58 
## j is  4 
## sum is  -16.80533 
## i is  58 
## j is  5 
## sum is  -16.23282 
## i is  59 
## j is  1 
## sum is  -16.48396 
## i is  59 
## j is  2 
## sum is  -17.25664 
## i is  59 
## j is  3 
## sum is  -18.60816 
## i is  59 
## j is  4 
## sum is  -17.17567 
## i is  59 
## j is  5 
## sum is  -19.35022 
## i is  60 
## j is  1 
## sum is  -19.52604 
## i is  60 
## j is  2 
## sum is  -19.14998 
## i is  60 
## j is  3 
## sum is  -19.67007 
## i is  60 
## j is  4 
## sum is  -21.23352 
## i is  60 
## j is  5 
## sum is  -21.88226 
## i is  61 
## j is  1 
## sum is  -22.79528 
## i is  61 
## j is  2 
## sum is  -23.74511 
## i is  61 
## j is  3 
## sum is  -23.16295 
## i is  61 
## j is  4 
## sum is  -22.84429 
## i is  61 
## j is  5 
## sum is  -23.73909 
## i is  62 
## j is  1 
## sum is  -22.28355 
## i is  62 
## j is  2 
## sum is  -21.08076 
## i is  62 
## j is  3 
## sum is  -21.53865 
## i is  62 
## j is  4 
## sum is  -18.83359 
## i is  62 
## j is  5 
## sum is  -18.09637 
## i is  63 
## j is  1 
## sum is  -18.93471 
## i is  63 
## j is  2 
## sum is  -17.23567 
## i is  63 
## j is  3 
## sum is  -17.50677 
## i is  63 
## j is  4 
## sum is  -16.84724 
## i is  63 
## j is  5 
## sum is  -17.15168 
## i is  64 
## j is  1 
## sum is  -18.44154 
## i is  64 
## j is  2 
## sum is  -17.9298 
## i is  64 
## j is  3 
## sum is  -19.57412 
## i is  64 
## j is  4 
## sum is  -19.42085 
## i is  64 
## j is  5 
## sum is  -19.73031 
## i is  65 
## j is  1 
## sum is  -20.6478 
## i is  65 
## j is  2 
## sum is  -21.45728 
## i is  65 
## j is  3 
## sum is  -21.69023 
## i is  65 
## j is  4 
## sum is  -21.82024 
## i is  65 
## j is  5 
## sum is  -22.44953 
## i is  66 
## j is  1 
## sum is  -22.37656 
## i is  66 
## j is  2 
## sum is  -22.93854 
## i is  66 
## j is  3 
## sum is  -22.30478 
## i is  66 
## j is  4 
## sum is  -21.79837 
## i is  66 
## j is  5 
## sum is  -21.04143 
## i is  67 
## j is  1 
## sum is  -21.30407 
## i is  67 
## j is  2 
## sum is  -20.2574 
## i is  67 
## j is  3 
## sum is  -20.02867 
## i is  67 
## j is  4 
## sum is  -20.31122 
## i is  67 
## j is  5 
## sum is  -19.65807 
## i is  68 
## j is  1 
## sum is  -19.63524 
## i is  68 
## j is  2 
## sum is  -19.10738 
## i is  68 
## j is  3 
## sum is  -18.88787 
## i is  68 
## j is  4 
## sum is  -17.85369 
## i is  68 
## j is  5 
## sum is  -19.04869 
## i is  69 
## j is  1 
## sum is  -19.90833 
## i is  69 
## j is  2 
## sum is  -17.84277 
## i is  69 
## j is  3 
## sum is  -17.25042 
## i is  69 
## j is  4 
## sum is  -19.03016 
## i is  69 
## j is  5 
## sum is  -20.131 
## i is  70 
## j is  1 
## sum is  -20.81731 
## i is  70 
## j is  2 
## sum is  -21.3123 
## i is  70 
## j is  3 
## sum is  -21.13671 
## i is  70 
## j is  4 
## sum is  -22.01562 
## i is  70 
## j is  5 
## sum is  -22.7453 
## i is  71 
## j is  1 
## sum is  -22.89679 
## i is  71 
## j is  2 
## sum is  -22.31604 
## i is  71 
## j is  3 
## sum is  -22.77059 
## i is  71 
## j is  4 
## sum is  -21.95494 
## i is  71 
## j is  5 
## sum is  -21.54692 
## i is  72 
## j is  1 
## sum is  -21.75882 
## i is  72 
## j is  2 
## sum is  -20.07445 
## i is  72 
## j is  3 
## sum is  -20.21105 
## i is  72 
## j is  4 
## sum is  -20.65543 
## i is  72 
## j is  5 
## sum is  -20.80898 
## i is  73 
## j is  1 
## sum is  -22.6349 
## i is  73 
## j is  2 
## sum is  -21.9283 
## i is  73 
## j is  3 
## sum is  -19.32435 
## i is  73 
## j is  4 
## sum is  -19.07972 
## i is  73 
## j is  5 
## sum is  -19.09414 
## i is  74 
## j is  1 
## sum is  -19.91121 
## i is  74 
## j is  2 
## sum is  -20.96357 
## i is  74 
## j is  3 
## sum is  -22.36535 
## i is  74 
## j is  4 
## sum is  -22.16596 
## i is  74 
## j is  5 
## sum is  -21.87295 
## i is  75 
## j is  1 
## sum is  -21.22191 
## i is  75 
## j is  2 
## sum is  -22.35539 
## i is  75 
## j is  3 
## sum is  -22.67127 
## i is  75 
## j is  4 
## sum is  -22.03792 
## i is  75 
## j is  5 
## sum is  -23.47865 
## i is  76 
## j is  1 
## sum is  -24.28343 
## i is  76 
## j is  2 
## sum is  -23.82905 
## i is  76 
## j is  3 
## sum is  -22.68507 
## i is  76 
## j is  4 
## sum is  -22.45383 
## i is  76 
## j is  5 
## sum is  -21.64308 
## i is  77 
## j is  1 
## sum is  -24.45226 
## i is  77 
## j is  2 
## sum is  -24.68298 
## i is  77 
## j is  3 
## sum is  -24.75107 
## i is  77 
## j is  4 
## sum is  -23.3108 
## i is  77 
## j is  5 
## sum is  -23.45676 
## i is  78 
## j is  1 
## sum is  -23.16257 
## i is  78 
## j is  2 
## sum is  -22.05213 
## i is  78 
## j is  3 
## sum is  -21.94245 
## i is  78 
## j is  4 
## sum is  -21.4213 
## i is  78 
## j is  5 
## sum is  -20.83093 
## i is  79 
## j is  1 
## sum is  -21.50651 
## i is  79 
## j is  2 
## sum is  -23.00082 
## i is  79 
## j is  3 
## sum is  -22.06033 
## i is  79 
## j is  4 
## sum is  -20.86986 
## i is  79 
## j is  5 
## sum is  -20.81296 
## i is  80 
## j is  1 
## sum is  -21.27644 
## i is  80 
## j is  2 
## sum is  -22.33334 
## i is  80 
## j is  3 
## sum is  -22.29157 
## i is  80 
## j is  4 
## sum is  -23.65247 
## i is  80 
## j is  5 
## sum is  -24.83161 
## i is  81 
## j is  1 
## sum is  -25.21449 
## i is  81 
## j is  2 
## sum is  -25.93704 
## i is  81 
## j is  3 
## sum is  -25.0445 
## i is  81 
## j is  4 
## sum is  -24.74892 
## i is  81 
## j is  5 
## sum is  -23.88648 
## i is  82 
## j is  1 
## sum is  -23.35056 
## i is  82 
## j is  2 
## sum is  -21.99254 
## i is  82 
## j is  3 
## sum is  -21.18283 
## i is  82 
## j is  4 
## sum is  -20.49257 
## i is  82 
## j is  5 
## sum is  -21.85952 
## i is  83 
## j is  1 
## sum is  -21.92562 
## i is  83 
## j is  2 
## sum is  -20.98978 
## i is  83 
## j is  3 
## sum is  -21.89245 
## i is  83 
## j is  4 
## sum is  -20.85111 
## i is  83 
## j is  5 
## sum is  -20.67539 
## i is  84 
## j is  1 
## sum is  -21.34116 
## i is  84 
## j is  2 
## sum is  -21.72444 
## i is  84 
## j is  3 
## sum is  -23.88442 
## i is  84 
## j is  4 
## sum is  -23.41418 
## i is  84 
## j is  5 
## sum is  -25.30431 
## i is  85 
## j is  1 
## sum is  -27.22229 
## i is  85 
## j is  2 
## sum is  -27.16105 
## i is  85 
## j is  3 
## sum is  -27.05797 
## i is  85 
## j is  4 
## sum is  -26.27657 
## i is  85 
## j is  5 
## sum is  -25.84557 
## i is  86 
## j is  1 
## sum is  -26.66869 
## i is  86 
## j is  2 
## sum is  -26.2361 
## i is  86 
## j is  3 
## sum is  -27.11089 
## i is  86 
## j is  4 
## sum is  -26.89552 
## i is  86 
## j is  5 
## sum is  -27.09179 
## i is  87 
## j is  1 
## sum is  -26.73154 
## i is  87 
## j is  2 
## sum is  -26.23431 
## i is  87 
## j is  3 
## sum is  -26.17828 
## i is  87 
## j is  4 
## sum is  -25.08424 
## i is  87 
## j is  5 
## sum is  -24.96432 
## i is  88 
## j is  1 
## sum is  -22.60701 
## i is  88 
## j is  2 
## sum is  -23.83081 
## i is  88 
## j is  3 
## sum is  -23.50165 
## i is  88 
## j is  4 
## sum is  -21.71381 
## i is  88 
## j is  5 
## sum is  -19.8387 
## i is  89 
## j is  1 
## sum is  -18.25549 
## i is  89 
## j is  2 
## sum is  -16.56754 
## i is  89 
## j is  3 
## sum is  -16.83845 
## i is  89 
## j is  4 
## sum is  -16.99699 
## i is  89 
## j is  5 
## sum is  -17.61309 
## i is  90 
## j is  1 
## sum is  -17.09015 
## i is  90 
## j is  2 
## sum is  -16.76107 
## i is  90 
## j is  3 
## sum is  -15.76514 
## i is  90 
## j is  4 
## sum is  -17.25912 
## i is  90 
## j is  5 
## sum is  -17.69441 
## i is  91 
## j is  1 
## sum is  -18.41101 
## i is  91 
## j is  2 
## sum is  -17.54319 
## i is  91 
## j is  3 
## sum is  -16.77536 
## i is  91 
## j is  4 
## sum is  -18.39728 
## i is  91 
## j is  5 
## sum is  -18.21698 
## i is  92 
## j is  1 
## sum is  -20.16001 
## i is  92 
## j is  2 
## sum is  -19.26406 
## i is  92 
## j is  3 
## sum is  -21.06407 
## i is  92 
## j is  4 
## sum is  -22.19655 
## i is  92 
## j is  5 
## sum is  -20.49915 
## i is  93 
## j is  1 
## sum is  -19.92339 
## i is  93 
## j is  2 
## sum is  -20.23214 
## i is  93 
## j is  3 
## sum is  -19.16691 
## i is  93 
## j is  4 
## sum is  -17.9843 
## i is  93 
## j is  5 
## sum is  -19.56042 
## i is  94 
## j is  1 
## sum is  -19.14933 
## i is  94 
## j is  2 
## sum is  -17.85147 
## i is  94 
## j is  3 
## sum is  -17.52985 
## i is  94 
## j is  4 
## sum is  -17.43132 
## i is  94 
## j is  5 
## sum is  -18.26962 
## i is  95 
## j is  1 
## sum is  -18.62711 
## i is  95 
## j is  2 
## sum is  -18.95086 
## i is  95 
## j is  3 
## sum is  -17.13142 
## i is  95 
## j is  4 
## sum is  -17.63795 
## i is  95 
## j is  5 
## sum is  -18.94932 
## i is  96 
## j is  1 
## sum is  -18.85717 
## i is  96 
## j is  2 
## sum is  -17.971 
## i is  96 
## j is  3 
## sum is  -16.59891 
## i is  96 
## j is  4 
## sum is  -15.80101 
## i is  96 
## j is  5 
## sum is  -15.60222 
## i is  97 
## j is  1 
## sum is  -16.05011 
## i is  97 
## j is  2 
## sum is  -15.7612 
## i is  97 
## j is  3 
## sum is  -15.44994 
## i is  97 
## j is  4 
## sum is  -15.86262 
## i is  97 
## j is  5 
## sum is  -15.11713 
## i is  98 
## j is  1 
## sum is  -14.63464 
## i is  98 
## j is  2 
## sum is  -15.19127 
## i is  98 
## j is  3 
## sum is  -15.72472 
## i is  98 
## j is  4 
## sum is  -17.16105 
## i is  98 
## j is  5 
## sum is  -18.35706 
## i is  99 
## j is  1 
## sum is  -17.51758 
## i is  99 
## j is  2 
## sum is  -17.21795 
## i is  99 
## j is  3 
## sum is  -16.99451 
## i is  99 
## j is  4 
## sum is  -16.26297 
## i is  99 
## j is  5 
## sum is  -16.65629 
## i is  100 
## j is  1 
## sum is  -17.84317 
## i is  100 
## j is  2 
## sum is  -18.42996 
## i is  100 
## j is  3 
## sum is  -17.45419 
## i is  100 
## j is  4 
## sum is  -18.28959 
## i is  100 
## j is  5 
## sum is  -17.95056
```

```
## Error in mat[i, j]: subscript out of bounds
```

---
layout: false
layout: true

# &lt;TT&gt;browser()&lt;/TT&gt;: Interactive debugger

---

Sometimes, it may not be enough to just use print statements and locate a bug. You can get more information and interact with that information using `browser()`, an interactive debugger.

Within RStudio, you can also get right to an interactive debugger by clicking `Rerun with Debug`.

.center[&lt;img src="images/traceback.png" alt="" height="50"/&gt;]

---

Alternatively, we can plug `browser()` into our function, similarly to the print statements.


```r
i &lt;- function(d) {
  browser()
  if (!is.numeric(d)) {
    stop("`d` must be numeric", call. = FALSE)
  }
  d + 10
}
f("a")
```


---

After you run a function with `browser()`, you will be *inside* of your function with an interactive debugger!

You will know it worked if you see a special prompt: `Browse[1]&gt;`.

We can see:

* The environment within the function using the Environment pane
* The call stack using the new Traceback pane
* Special interactive debugging commands

.center[&lt;img src="images/debug.png" alt="" height="50"/&gt;]


---

.center[.huge[[Demo](https://raw.githubusercontent.com/peteragao/STAT302-AUT2021/base/files/slides/07_debuggit.Rmd)]]

&lt;br/&gt;


```r
# BROWSER DEMO
f &lt;- function(a) g(a)
g &lt;- function(b) h(b)
h &lt;- function(c) i(c)
i &lt;- function(d) {
  browser()
  if (!is.numeric(d)) {
    stop("`d` must be numeric", call. = FALSE)
  }
  d + 10
}
f("a")
```

---

## Interactive debugging commands

.center[&lt;img src="images/debug.png" alt="" height="40"/&gt;]

* Next, `n`: executes the next step in the function. (If you have a variable named `n`, use `print(n)` to display its value.)

* Step into, &lt;img src="images/stepin.png" alt="" height="22"/&gt; or `s`: works like next, but if the next step is a function, it will step into that function so you can explore it interactively. (Easy to get lost!)

* Finish, &lt;img src="images/finish.png" alt="" height="22"/&gt; or `f`: finishes execution of the current loop or function. Useful to skip over long for loops you don't need to interact with.

* Continue, `c`: leaves the debugger and continues execution of the function. Useful if you’ve fixed the bad state and want to check that the function proceeds correctly.

* Stop, `Q`: exits the debugger and returns to the R prompt.

---

## Interactive debugging commands

.center[&lt;img src="images/debug.png" alt="" height="40"/&gt;]

* Enter (no text): repeat the previous interactive debugging command. Defaults to Next `n` if you haven't used any debugging commands yet.

* `where`: prints stack trace of active calls (the interactive equivalent of `traceback`).

---

## Other useful things to do

* `ls()`: List the current environment. You can use this to browse everything that the function is able to see at that moment.

* `str()`, `print()`: examine objects as the function sees them.

---

## A Note

If you execute the step of a function where the error occurs, you will exit interactive debugging mode, the error message will print, and you will be returned to the R prompt!
This can get annoying, because it stops you from interacting right when you hit the bug.

What I often do is execute my function within an interactive debugger until I hit the error so I know exactly where the error occurs. Then I execute my function again within an interactive debugger, stopping just before I trigger the error.
To check I'm in the right place, I then copy and paste the next line of code into my `Browse` console.
This will trigger the error without exiting the interactive debugger.

---


```r
sum_matrix &lt;- function(mat) {
  browser()
  curr_sum &lt;- 0
  for (i in 1:(nrow(mat))) {
    for (j in 1:ncol(mat)) {
      curr_sum &lt;- curr_sum + mat[i, j]
    }
  }
  curr_sum &lt;- curr_sum + mat[nrow(mat) + 1, 1]
}
```

---
layout: false

# &lt;TT&gt;debug()&lt;/TT&gt;: debug a function

If you want to enter the debugger for a function within a package, you can't just insert a `browser()`. 
Even for your own functions, it may be more convenient to debug the entire function rather than edit the source code.
When a function is in debug mode, it will remain in debug mode until you call `undebug()`.

---

# &lt;TT&gt;debug()&lt;/TT&gt;: debug a function

.center[.huge[[Demo](https://raw.githubusercontent.com/peteragao/STAT302-AUT2021/base/files/slides/07_debuggit.Rmd)]]

&lt;br/&gt;


```r
# DEBUG DEMO
debug(lm)
lm(mpg ~ wt, data = mtcars)
debug(f)
f("a")
undebug(lm)
undebug(f)
```

---

# &lt;TT&gt;debugonce()&lt;/TT&gt;: debug a function

It can get tedious to `undebug()` every function you flagged with `debug()`.
As an alternative, you can call `debugonce()`, which will automatically undebug the function as soon as you exit the interactive debugger.


```r
debugonce(lm)
lm(mpg ~ wt, data = mtcars)
debugonce(f)
f("a")
```

---

# Debugging Summary

.middler-nocent[
### 1. Google!
### 2. Reset!
### 3. Repeat!

### 4. Locate:
* Call stack: `traceback()`
* Non-interactive messages: `print()`, `cat()`, `str()`
* Interactive debugging:  `browser()`, `debug()`,
`debugonce()`
* Interactive debugging commands: Next `n`, Step into &lt;img src="images/stepin.png" alt="" height="22"/&gt; `s`, Finish &lt;img src="images/finish.png" alt="" height="22"/&gt; `f`, Continue `c`, Stop `Q`, `where`
]

---

# Debugging Resources

.middler-nocent[
* [Advanced R Debugging - Hadley Wickham ](https://adv-r.hadley.nz/debugging.html)
* [What they Forgot to Teach You About R - Jennifer Bryan and Jim Hester](https://rstats.wtf/debugging-r-code.html)
* [Debugging Techniques in RStudio - Amanda Gadrow](https://resources.rstudio.com/wistia-rstudio-conf-2018-2/debugging-techniques-in-rstudio-amanda-gadrow-4)
* [Debugging with RStudio Article - Jonathan McPherson](https://support.rstudio.com/hc/en-us/articles/200713843)
* [Introduction to debugging in R and RStudio - Jim Hester](https://www.jimhester.com/talk/2019-crug-debugging/)

&lt;br/&gt;

.center[[Cheatsheet](https://github.com/ajmcoqui/debuggingRStudio/blob/b70a3575a3ff5e7867b05fb5e84568abba426c4b/RStudio_Debugging_Cheatsheet.pdf)]
]

---

# Today's pet picture 


&lt;img src="../../files/images/pets/tired_pup.jpeg" width="700px" style="display: block; margin: auto;" /&gt;

Thanks Xiangyi! 

---

class: inverse

.sectionhead[Part 2. Version Control]

---

# Acknowledgement

Much of this section, particularly the install guide and getting started section, borrow heavily from the fantastic [Happy Git and GitHub for the useR](https://happygitwithr.com/) by Jenny Bryan and others.

---
layout: true
# Version Control
---

Have you ever had a paper/code look like this:

* draft1.docx
* Draft2.docx
* draft2_profcomments.docx
* draft_final.docx
* draftFINAL.docx
* finaldraftFinal.docx
* finalDraftFinal-comments.docx
* actualfinaldraft.docx
* actualfinaldraft2.docx
* thetruerealfinaliamdonewiththispaper.docx
* aaaaaaaguhgh.docx
* fdajsglasjdfFINISHED.docx

`\(\hspace{5em} \vdots\)`

---

.center[
&lt;img src="images/phdcomics.png" alt="" height="575"/&gt;
]

---

.middler-nocent[
* At some point, this is going to interfere with your workflow
* Reversion can get difficult and border on impossible
* *Date modified* sorting can only get you so far
* Susceptible to computer crashes
* Makes working with collaborators a pain (who did what? when?)
]

---

Cloud-based services, like Dropbox and Google Drive, can help you with some of these challenges. 
In particular, they can make working with collaborators easier, because all changes will be synchronized and you will be able to always see the most recent version.

However, how will you know:

* Who changed what?
* When specific components were changed?
* What was on a previous version?

---

We want something that:

1. Keeps old versions indefinitely (tracking changes, reversions become easy)
2. Keeps track of who changed what and when they changed it
3. Changes are automatically integrated into the most recent version, and conflicts receive warnings
4. Work with multiple collaborators

---
layout: false

# Git

**git** is an open-source version control system. 
git tracks all changes to all files in a project over time so there is a comprehensive record of each version of the project.

Each project is stored inside of a **repository** (similar structure to when we work with R projects!). The repository contains all relevant files to the project.

For large software projects, this usually means our repository contains folders and subfolders with source code, write-ups, data, etc.

---
# Data Analysis Repository Example

A possible (recommended) structure is to use `Data`/`Code`/`Analysis`/`Output`.

* `Data`: Raw and unprocessed data files. Put files in here to load, never edit the files within `Data`!
* `Code`: Put .R (or .py, etc.) files here. They can be loaded into .Rmd files or your writing, so that the same code files can be used across multiple files
* `Analysis`: Put .Rmd (or other text) files here. These files allow you to present your results.
* `Output`: Figures (.pdf, .png, etc), saved analysis output (.Rdata, .rda), and other files containing code output. You code should save output in a systematic way (not through the menu bar!) so that revisions are automatically worked throughout your analysis

---
# GitHub

git is software that can be used locally. 
You do not need access to the internet to do proper version control on your computer. 
However, if you want to share your work or collaborate with others, it is best to use an online repository hub such as **GitHub**.

Like RStudio with R, GitHub adds many user-friendly features to git. 

* Effective collaboration
* Code distribution
* Allow others to comment on your code and suggest changes (pull requests/issues)
* Building your coding portfolio!

---
class: inverse

.sectionhead[Please follow along with any slides marked with (*).]

---

# Poll
## What type of operating system are you using?

* Mac? 
* Windows? 
* Linux? 
* Other?

---

# Install Git (*)

Installing and connecting all the software you need is truly half the battle.

* **Mac:** You are probably already done. Open the `Terminal` app and type `git --version` to find out which version you have and `which git` to find out where it is. If you see an offer to install command line tools, do so!
  * If for some reason you don't have git pre-installed, you can download it from [here](http://git-scm.com/downloads).

* **Linux:** You are probably already done. Open your console and type type `git --version` to find out which version you have and `which git` to find out where it is. If you don't have it, then install:
  * Ubuntu or Debian Linux: `sudo apt-get install git`
  * Fedora or RedHat Linux: `sudo yum install git`
  
---

# Install Git - Windows (*)
  
* **Windows:** 

 * Install [Git for Windows](https://gitforwindows.org/) (also known as `msysgit` or "Git Bash")
 * **Important note:** When asked about "Adjusting your PATH environment", make sure to select "Git from the command line and also from 3rd-party software".
 * Note that RStudio for Windows prefers for Git to be installed below `C:/Program Files` and this appears to be the default. This implies, for example, that the Git executable on my Windows system is found at `C:/Program Files/Git/bin/git.exe`. Unless you have specific reasons to otherwise, follow this convention.
 
Hopefully, after following the instructions above, you have a Git Bash shell. To check this, open your shell and type `echo $SHELL`. You should see something like `usr/bin/bash`.

---

# Shell

The **shell** is a program on your computer that runs other programs. 
Sometimes people use the terms `Terminal`, `Console`, `Command Line`, and `Shell` interchangably.

You can open a shell within RStudio:
  * *Tools &gt; Terminal* to launch a shell within RStudio. This will often be sufficient for our purposes
  * **Windows:** For this class, we will focus on the **Git Bash** shell, which should have come with your install of Git for Windows. First, confirm that RStudio detected the presence of Git Bash. This should have happened automatically if you installed in the default location, but check by going to *Tools &gt; Global Options &gt; Terminal* and make sure you see "Git Bash" under "New terminals open with:".
  
---

# Shell
  
To open a shell outside of RStudio:
  * Mac/Linux: Search for the application `Terminal` on your computer and open it.
  * Windows: The easiest way is to open "Git" within the Windows menu and select "Git Bash". You may sometimes need to run Git Bash as an administrator, in which case you should right click and select that option.
  
---

# Basic Shell Commands

* `pwd` (**p**rint **w**orking **d**irectory). Shows the current working directory of your shell.
* `ls` (**l**ist **f**iles). Shows the files in the current working directory. Use `ls -a` to also list hidden files, such as .Rhistory and .git.
* `cd` (**c**hange **d**irectory). Allows you to navigate through your directories by changing the shell’s working directory.
  * You can still use relative paths such as `..` and `.`
  * `~` is still your home directory
  * You can drag and drop a file or folder into the shell window to paste the absolute path
  * You can use `Tab` to autocomplete unambiguous directory and file names. 
* Navigate previous commands with arrow-up and arrow-down

---
# How does git work? 

&lt;img src="../../files/images/git_diagram.svg" width="800px" style="display: block; margin: auto;" /&gt;

[Image source](https://support.nesi.org.nz/hc/en-gb/articles/360001508515-Git-Reference-Sheet)

---

# Basic git commands 

These commands are used within a shell

* `git status` Informs you of any changes or untracked files, and whether you are in sync with your remote repository (on github.com).
* `git remote -v` lists all remotes. Very useful for making sure git knows about your remote repository and that the remote address (url) is correct.
* `git add FILENAME` stages changes to the file `FILENAME`. Will add the file to the tracked files if it isn't already. Use `git add .` to add all untracked files (but be careful with this!)
* `git commit -m "COMMIT MESSAGE"` commit all staged changes to local copy
* `git push` pushes from local copy to remote
* `git pull` pulls from remote to local copy

---

# Register a GitHub Account (*)

Go to [https://github.com](https://github.com) and register a free account!
Remember, GitHub can become a part of your professional portfolio, and it likely will if you plan to do any coding as part of your career. So choose your username **carefully**! Some rules of thumb:

* Incorporate your actual name to increase visibility and recognizability
* Shorter is better than longer
* You should be willing to show your boss
* Make it timeless (don't include your current university affiliation, etc)
* All lowercase is recommended

All users get unlimited free private repositories with up to three collaborators. As students, you alo can sign up for free student benefits at [https://education.github.com/](https://education.github.com/), which includes unlimited free private repositories with unlimited collaborators. If you plan to use GitHub after this class, I would recommend doing this! 

---
# Introduce yourself to Git (*)

Run the following in your R session:


```r
install.packages("usethis", "gitcreds")
```

Then this:


```bash
library(usethis)
use_git_config(
  user.name = "Firstname Lastname",
  user.email = "email@website.com"
)
```

**Note:** The email should be the email associated with your GitHub account!

---
# Introduce yourself to Git (*)

Alternatively , run the following in your shell (filling in your information, of course):


```bash
git config --global user.name 'Firstname Lastname'
git config --global user.email 'email@website.com'
git config --global --list
```

**Note:** The email should be the email associated with your GitHub account!

---
# Introduce your computer to GitHub (*)

When using GitHub, you typically need to verify your identity using a Personal Access Token (PAT).

In R, run:


```r
usethis::create_github_token()
```

For now, select scopes "repo", "user", and "workflow"  (will be pre-selected). Copy the generated PAT to your clipboard. Leave this browser window open so you can come back to copy the PAT!

In R, call `gitcreds::gitcreds_set()` to paste your PAT:


```sh
&gt; gitcreds::gitcreds_set()
? Enter password or token: ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
-&gt; Adding new credentials...
-&gt; Removing credentials from cache...
-&gt; Done.
```

---

class: inverse

.sectionhead[The next few things will be your submission for Short Lab 4]

---
# Create a git repo (*)

.middler-nocent[
1. Go to GitHub and click the green "New Repository" button. 
2. Repository name: `shortlab4` or similar, following the naming conventions you've used in the class so far.
3. Description: Whatever you want, but fill in something.
4. Public or Private: Please choose public, this will make grading easier. Feel free to delete this repository or make it private after grades are released for Short Lab 4. 
5. YES initialize the repository with a README.
]

---
# Clone your git repo (*) 
## One way to work with git and RStudio 


.middler-nocent[
1. Open a shell window.
2. **Change your working directory to your `ShortLabs` (or similar) parent folder for your short labs.**
3. Clone the repo by entering (filling in the relevant info):
  
  ```bash
  git clone https://github.com/YOUR-USERNAME/YOUR-REPOSITORY.git
  ```
  Note that you can get the direct link by navigating to your repo and clicking the green "Clone or download" button and copying the text there.

4. Explore your repo by entering the following (replace YOUR-REPOSITORY with the name of your respository):
  
  ```bash
  cd YOUR-REPOSITORY
  ls
  head README.md
  git remote show origin
  git status
  ```
]

---

# Commit and push a local change (*)

1. Edit your README within shell by using the following line.
  
  ```bash
  echo "A line I wrote using the shell on my local computer" &gt;&gt; README.md
  ```

2. Check the status
  
  ```bash
  git status
  ```

3. Stage your commit and check the status
  
  ```bash
  git add .
  git status
  ```

4. Commit and push and check the status
  
  ```bash
  git commit -m "A commit from my local computer"
  git push
  git status
  ```
  
Now check the repository online at GitHub. What changed?




---

# Add Short Lab 4 (*)


1. Navigate to [the shortlab section of the course webpage](https://svteichman.github.io/STAT302-SPR2022/short_labs.html).
2. Download the .Rmd for Short Lab 4.
3. Using your standard file browser, copy the .Rmd into the `shortlab4` or similarly named folder (git repo) you created.
4. In RStudio, in the Short Lab 4 .Rmd, fill in the required text for the link to your repo.
5. Knit/Compile Short Lab 4. 
6. Add, commit, and push the change to your remote repository following the steps 3 and 4 from the previous slide.

Now check the repository online at GitHub. If you see a README, .Rmd, and .html, then congratulations, you are done with this step!

---

# Note on credentials (*)

Hopefully, with your second pushed commit, you weren't prompted to re-enter your GitHub credentials. If this is true, then you can skip this slide.

If you were prompted to re-enter your GitHub credentials, then please follow the instruction in [Chapter 10 of happygitwithr](https://happygitwithr.com/credential-caching.html).


---

# Use git through RStudio (*)
## A second (and better) way to work with git and RStudio 

1. Delete the local repository on your computer (pretend that we never cloned the Short Lab 4 repository on to your computer).
2. In RStudio, click *File &gt; New Project &gt; Version Control &gt; Git*. In the "repository URL", paste the HTTPS URL for your repository.
3. **Create this project within your `ShortLabs` parent directory for short labs!**
4. Click "Open in new session"

**This is the recommended set up for all of your R projects!** 

That is, first create on GitHub, then clone through RStudio.


---

# Edit your repo through RStudio (*)

You should now have re-created the `shortlab4` (or similar) sub-folder within `ShortLabs`, and it should be associated with an R project.
If it is not already open, open that R project by double clicking on the project file.

**You should now see a `Git` pane within RStudio!**

1. Within the `Files` pane of RStudio, open `README.md`.
2. Add a new line of text "A commit from RStudio" to `README.md` and save.
3. Click `Diff` within the `Git` pane.
4. Click the box under `Staged` for the changed file (top left box).
5. Add a commit message within the box (top right).
6. Click `Commit` (top right).
6. Click `push` (top right).


---

# Finished with Short Lab 4? (*)

Now check the repository online at GitHub. You should see a README, .Rmd, and .html.
Your README should include two lines indicating that it was edited from both the shell on your local computer and RStudio.

If this is true, then congratulations, you are done with this Short Lab 4!

If this is not true, then let me know and we will work through it together!

---

# More on git and GitHub

Check out [Happy Git and GitHub for the useR](https://happygitwithr.com/) by Jenny Bryan and others for more details on much of what we went over for this section.

There are also several helpful public cheatsheets available for [git](https://www.atlassian.com/git/tutorials/atlassian-git-cheatsheet).
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "default",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
